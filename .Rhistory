penalty.ts <- ts(penalty$CNT, start=c(2010,1), frequency = 12)
penalty.decompose <- decompose(penalty.ts)
plot(penalty.decompose)
penalty.diff1 <- diff(Nile, differences = 1)
plot(penalty.diff1)
penalty.diff2 <- diff(Nile, differences = 2)
plot(penalty.diff2)
penalty.diff1 <- diff(penalty.ts, differences = 1)
penalty.diff1 <- diff(penalty.ts, differences = 2)
penalty.diff1 <- diff(penalty.ts, differences = 1)
penalty.diff2 <- diff(penalty.ts, differences = 2)
plot(penalty.diff1)
plot(penalty.diff2)
plot(penalty.diff1)
plot(penalty.diff2)
acf(penalty.diff1, lag.max = 20)
pacf(penalty.diff1, lag.max = 20)
auto.arima(penalty.ts)
penalty.arima <- arima(penalty.ts, order=c(2,1,0))
penalty.arima
penalty.forecasts <- forecast(penalty.arima, h=12)
plot(penalty.forecasts)
save.image("~/17?„ì—­?‰ê°œë°?Time Series Forecasting/?¤ë¬´?ìš©/penalty_workspace.RData")
read.csv("c:\\p440.csv"")
""
read.csv("c:\\p440.csv")
ceo <- read.csv("c:\\p440.csv")
summary(ceo)
var(ceo$salary)
sd(ceo$salary)
sd(ceo$tenure)
plot(ceo$salary, ceo$profits)
plot(ceo$profits,ceo$salary )
coef(ceo$profits,ceo$salary )
cor(ceo$profits,ceo$salary )
lm(salary~profits, data=ceo)
summary(lm(formula = salary ~ profits, data = ceo))
glm(salary~profits+age+sales, data=ceo)
summary(glm(salary~profits+age+sales, data=ceo))
summary(lm(salary~profits+age+sales, data=ceo))
lm(salary~profits+age+sales, data=ceo)
lm(salary~profits+age+sales+tenure+assets, data=ceo)
a5 <- lm(salary~profits+age+sales+tenure+assets, data=ceo)
summary(a5)
a5 <- lm(salary~profits+age+tenure+assets, data=ceo)
summary(a5)
step(lm(salary~, data=ceo), direction="backward")
step(lm(salary~., data=ceo), direction="backward")
step(lm(salary~., data=ceo), direction="forward")
step(lm(salary~1, data=ceo), direction="forward")
step(lm(salary~1, data=ceo), scope=list(lower=~tenure+age+sales+profits+assets), direction="forward")
step(lm(salary~1, data=ceo), scope=list(lower=-1,upper=~tenure+age+sales+profits+assets), direction="forward")
step(lm(salary~1, data=ceo), scope=list(lower=~1,upper=~tenure+age+sales+profits+assets), direction="forward")
step(lm(salary~1, data=ceo), scope=list(lower=~1,upper=~tenure+age+sales+profits+assets), direction="both")
library("nnet", lib.loc="C:/Program Files/R/R-3.4.0/library")
install.packages("Matrix")
library("nnet", lib.loc="C:/Program Files/R/R-3.4.0/library")
m.iris <- mnet(Species~., data=iris, size=2, range=0.1, decay=5e-4, maxit=200)
m.iris <- nnet(Species~., data=iris, size=2, range=0.1, decay=5e-4, maxit=200)
m.iris <- nnet(Species~., data=iris, size=2, range=0.1, decay=5e-4, maxit=200)
summary(m.iris)
install.packages("devtools")
library("devtools", lib.loc="C:/Program Files/R/R-3.4.0/library")
plot.nnet(m.iris)
source_url("https://gist.githubusercontent.com/fawda123/7471137/raw/466c1474d0a505ff044412703516c34f1a4684a5/nnet_plot_update.r")
plot.nnet(m.iris)
install.packages("clusterGeneration")
install.packages("scales")
library("clusterGeneration", lib.loc="C:/Program Files/R/R-3.4.0/library")
library("scales", lib.loc="C:/Program Files/R/R-3.4.0/library")
library("reshape", lib.loc="C:/Program Files/R/R-3.4.0/library")
plot(m.iris)
plot(m.iris)
m.iris <- nnet(Species~., data=iris, size=2, range=0.1, decay=5e-4, maxit=200)
plot(m.iris)
summary(m.iris)
plot(m.iris)
detach("package:clusterGeneration", unload=TRUE)
library("clusterGeneration", lib.loc="C:/Program Files/R/R-3.4.0/library")
detach("package:reshape", unload=TRUE)
library("reshape", lib.loc="C:/Program Files/R/R-3.4.0/library")
detach("package:scales", unload=TRUE)
library("scales", lib.loc="C:/Program Files/R/R-3.4.0/library")
plot(m.iris)
library("devtools", lib.loc="C:/Program Files/R/R-3.4.0/library")
plot(m.iris)
table(iris@Species, predict(m.iris, iris, type="class"))
table(iris$Species, predict(m.iris, iris, type="class"))
data("infert", package = "datasets")
str(infert)
library(neuralnet)
install.packages("neuralnet")
library("neuralnet", lib.loc="C:/Program Files/R/R-3.4.0/library")
net.infert <- neuralnet(case~age+parity+induced, data=infert, hidden=2, err.fct = "ce", linear.output = FALSE, likelihood = TRUE)
net.infert
net.infert <- neuralnet(case~age+parity+induced+spontaneous, data=infert, hidden=2, err.fct = "ce", linear.output = FALSE, likelihood = TRUE)
net.infert
net.infert <- neuralnet(case~age+parity+induced+spontaneous, data=infert, hidden=2, err.fct = "ce", linear.output = FALSE, likelihood = TRUE)
net.infert
net.infert
summary(net.infert)
plot(net.infert)
net.infert <- neuralnet(case~age+parity+induced+spontaneous, data=infert, hidden=2, err.fct = "ce", linear.output = FALSE, likelihood = TRUE)
plot(net.infert)
net.infert <- neuralnet(case~age+parity+induced+spontaneous, data=infert, hidden=2, err.fct = "ce", linear.output = FALSE, likelihood = TRUE)
plot(net.infert)
plot(net.infert)
names(net.infert)
net.infert$result.matrix
net.infert$weights
train.input <- as.data.frame(runif(50, min = 0, max=100))
train.output <- sqrt(train.input)
train.data <- cbind(train.input, train.output)
colnames(train.data) <- c("input","output")
head(train.data)
net.sqrt <- neuralnet(output~input, train.data, hidden=10, threshold = 0.01)
print(net.sqrt)
plot(net.sqrt)
plot(net.sqrt)
test.data <- as.data.frame((1:10)^2)
test.out <- compute(net.sqrt, test.data)
ls(test.out)
print(test.out$net.result)
net2.sqrt <- neuralnet(output~input, train.data, hidden=c(10,8), threshold = 0.01)
plot(net2.sqrt)
library(rpart)
c <- rpart(Species~.,data=iris)
c
plot(c)
plot(c, compress = T, margin=0.3)
text(c, cex=1.5)
head(predict(c, newdata=iris, type="class"))
tail(predict(c, newdata=iris, type="class"))
library(rpart.plot)
install.packages("rpart.plot")
library(rpart.plot)
ls(c)
c$cptable
opt <- which.min(c$cptable[, "xerrpr"])
opt <- which.min(c$cptable[, "xerror"])
cp <- c$cptable[opt, "CP"]
prune.c <- prune(c, cp= cp)
plot(prune.c)
text(prune.c, use.n = T)
plot(prune.c, compress = T, margin = 0.3)
text(prune.c, use.n = T)
plot(c)
plotcp(c)
install.packages("party")
install.packages("party")
install.packages("forecast")
install.packages("party")
install.packages("C:/Users/02530/Downloads/party_1.2-3.tar.gz", repos = NULL, type = "source")
install.packages("party")
install.packages("party")
install.packages("rpart.plot")
library("rpart.plot", lib.loc="C:/Program Files/R/R-3.4.0/library")
c < rpart(Species~., data=iris)
c <- rpart(Species~., data=iris)
prp(c, type = 4, extra = 2)
library(party)
data("stagec")
str(stagec)
stagec1<- subset(stagec, !is.na(g2))
stagec2<- subset(stagec1, !is.na(gleason))
stagec3<- subset(stagec3, !is.na(eet))
stagec3<- subset(stagec2, !is.na(eet))
str(stagec3)
set.seed(1234)
ind <- sample(2,nrow(stagec3), replace = TRUE, prob = c(0.7,0.3))
ind
trainData <- stagec3[ind==1,]
testData <-stagec3{ind==2,}
testData <-stagec3{ind==2,]
testData <-stagec3[ind==2,]
tree <- ctree(ploidy ~., data=trainData)
tree
plot(tree)
tetPred = predict(tree, newdata=testData)
table ( testPred, testData$ploidy)
table ( tetPred, testData$ploidy)
tetPred
airq <- subset(airquality, !is.na(Ozone))
head(airq)
airct <- ctree(Ozone~., data=airq)
airct
plot(airct)
head(predict(airct, data=airq))
predict(airct, data=airq, type="node")
mean((airq$Ozone - predit(airct))^2)
mean((airq$Ozone - predict(airct))^2)
library(adabag)
install.packages("adabag")
install.packages("adabag")
library("adabag", lib.loc="C:/Program Files/R/R-3.4.0/library")
data("iris")
boo.adabag <- boosting($Species~., data=iris, boos=TRUE, mfinal=10)
boo.adabag <- boosting(Species~., data=iris, boos=TRUE, mfinal=10)
boo.adabag$importance
bot.adabag
boo.adabag
str(boo.adabag)
ls(boo.adabag)
plot(boo.adabag$trees)
plot(boo.adabag$trees[[10]])
plot(boo.adabag$trees[[10]])
text(boo.adabag$trees[[10]])
plot(boo.adabag$trees[[10]], margin=0.3)
text(boo.adabag$trees[[10]])
plot(boo.adabag$trees[[10]], margin=1)
plot(boo.adabag$trees[[10]], margin=0.1)
text(boo.adabag$trees[[10]])
boo.adabag <- boosting(Species~., data=iris, boos=TRUE, mfinal=10)
plot(boo.adabag$trees[[10]], margin=0.1)
text(boo.adabag$trees[[10]])
boo.adabag <- boosting(Species~., data=iris, boos=TRUE, mfinal=10)
plot(boo.adabag$trees[[10]], margin=0.1)
text(boo.adabag$trees[[10]])
pred <- predict((boo.adabag, newdata=iris))
pred <- predict(boo.adabag, newdata=iris)
tb < - table(pred$class, iris[,5])
tb <- table(pred$class, iris[,5])
tb
error.report <- 1-(sum(diag(tb))/sum(tb))
error.report
library(ada)
install.packages("ada")
library(ada)
data("iris")
iris[iris$Species!="setosa",] -> iris
n <- dim(iris)[1]
n
trind <- sample(1:n, fLoor(.6*n), FALSE)
trind <- sample(1:n, floor(.6*n), FALSE)
n
floor(.6*n)
trind
teind <- setdiif(1;n, trind)
teind <- setdiif(1:n, trind)
teind <- setdiff(1:n, trind)
data("ChickWeight")
head(ChickWeight)
colnames(ChickWeight)
ggplot(ChickWeight, aes(x=Time,y-weoght, colour=Diet, group=Chick)) +geom_line()
library("ggplot2", lib.loc="C:/Program Files/R/R-3.4.0/library")
ggplot(ChickWeight, aes(x=Time,y-weoght, colour=Diet, group=Chick)) +geom_line()
ggplot(ChickWeight, aes(x=Time,y=weight, colour=Diet, group=Chick)) +geom_line()
ggplot(ChickWeight, aes(x=Time,y=weight, colour=Diet, group=Chick)) +geom_point(alpha=.3)+geom_smooth(alpha=0.2, size= 1)
ggplot(ChickWeight, aes(x=Time,y=weight, colour=Diet, group=Chick)) +geom_point(alpha=.3)+geom_smooth(alpha=.2, size= 1)
ggplot(ChickWeight, aes(x=Time,y=weight, colour=Diet, group=Chick)) +geom_point(alpha=.3)
h <- ggplot(ChickWeight, aes(x=Time,y=weight, colour=Diet, group=Chick)) +h+geom(alpha=0.4, size=3)
h <- ggplot(ChickWeight, aes(x=Time,y=weight, colour=Diet, group=Chick))
h
h+geom(alpha=0.4, size=3)
h+geom_smooth(alpha=0.4, size=3)
h+geom_smooth(alpha=0.4, size=3, method ="auto")
warnings()
ggplot(subset(ChickWeight, Time==2), aes(x=weight, colour=Diew)) + geom_density()
ggplot(subset(ChickWeight, Time==2), aes(x=weight, colour=Diet)) + geom_density()
ggplot(subset(ChickWeight, Time==2), aes(x=weight, fill=Diet)) + geom_histogram(colour="black" binwidth= 50)+facet_grid(Diet ~ .)
ggplot(subset(ChickWeight, Time==2), aes(x=weight, fill=Diet)) + geom_histogram(colour="black" binwidth= 50)
ggplot(subset(ChickWeight, Time==2), aes(x=weight, fill=Diet))
ggplot(subset(ChickWeight, Time==2), aes(x=weight, fill=Diet)) + geom_histogram(colour="black" binwidth=50)
ggplot(subset(ChickWeight, Time==2), aes(x=weight, fill=Diet)) + geom_histogram(colour="black", binwidth= 50)+facet_grid(Diet ~ .)
ggplot(subset(ChickWeight, Time==21), aes(x=weight, fill=Diet)) + geom_histogram(colour="black", binwidth= 50)+facet_grid(Diet ~ .)
ggplot(subset(ChickWeight, Time==21), aes(x=weight, fill=Diet)) + geom_histogram(colour="black", binwidth= 50)+facet_grid(. ~ Diet )
data(mtcars)
head(mtcars)
p <- qplot (wt, mpg, colour = hp, data=mtcars)
p+ coord_cartesian(ylm = c(0,40)
)
p+ coord_cartesian(ylm = c(0,40))
p+ coord_cartesian(ylim = c(0,40))
p+ scale_color_continuous(breaks = c(100,300))
p+guide(colour = "colourbar")
p+guides(colour = "colourbar")
p <- qplot (wt, mpg, colour = hp, data=mtcars)
p+ coord_cartesian(ylim = c(0,40))
p+ scale_color_continuous(breaks = c(100,300))
p+guides(colour = "colourbar")
m <-mtcars[1:10,`]
''
''
""
]
'
'
'
,,,
.
X
''
''''''''''
''
''''''
m_m
m<-ddd
ddafasfdas
rescale01 <- funcation(x) (x- min(x))/diff(range(x))
rescale01 <- function(x) (x- min(x))/diff(range(x))
ec_scaled <- data.frame(data = economics$date, colwise(recale01(economices[,-1(1;2)])))
ec_scaled <- data.frame(data = economics$date, colwise(recale01)(economices[,-1(1;2)]))
ec_scaled <- data.frame(data = economics$date, colwise(recale01)(economices[,-1(1:2)]))
ec_scaled <- data.frame(data = economics$date, colwise(recale01)(economics[,-1(1:2)]))
data(economics)
data(economics)
library("ggplot2", lib.loc="C:/Program Files/R/R-3.4.0/library")
data("economics")
ec_scaled <- data.frame(data = economics$date, colwise(recale01)(economics[,-1(1:2)]))
library("reshape2", lib.loc="C:/Program Files/R/R-3.4.0/library")
library("plyr", lib.loc="C:/Program Files/R/R-3.4.0/library")
ec_scaled <- data.frame(data = economics$date, colwise(recale01)(economics[,-1(1:2)]))
rescale01 <- function(x) (x- min(x))/diff(range(x))
ec_scaled <- data.frame(data = economics$date, colwise(rescale01)(economics[,-1(1:2)]))
ec_scaled <- data.frame(data = economics$date, colwise(rescale01)(economics[,-(1:2)]))
ecm ,_ melt(ec_scale, id ="date")
ecm <- melt(ec_scale, id ="date")
ecm <- melt(ec_scaled, id ="date")
ec_scaled
ecm <- melt(ec_scaled, id ="data")
f<- ggplot(ecm, aes((data,value)))
f<- ggplot(ecm, aes(date,value)))
f<- ggplot(ecm, aes(date,value))
f + geom_line(linetpye = variable
)
f + geom_line(linetpye = variable)
f<- ggplot(ecm, aes(data,value))
f + geom_line(linetpye = variable)
quit()
read.csv("c:\\champaine-sales.csv", header=T, sqp=",")
read.csv("c:\\champaine-sales.csv", header=T, sep=",")
read.csv("c:\\champagne-sales.csv", header=T, sep=",")
sales
sales <-read.csv("c:\\champagne-sales.csv", header=T, sep=",")
sales.ts <- ts(sales$Champagne.Sales, start=c(2001,1), frequency = =12)
sales.ts <- ts(sales$Champagne.Sales, start=c(2001,1), frequency =12)
sales.ts
plot(sales.ts)
ts1<-diff(sales.ts, differences = 1)
plot(ts1)
ts2<-diff(sales.ts, differences = 2)
plot(ts2)
ts2[-6,]
ts2[-c(1:6),]
ts
ts2
str(ts2)
ts2[1:88]
sales.data_ts <- ts2[1:88]
sales.test_ts <- ts2[89:94]
library("ggplot2", lib.loc="C:/Program Files/R/R-3.4.0/library")
library("forecast", lib.loc="C:/Program Files/R/R-3.4.0/library")
library("tseries", lib.loc="C:/Program Files/R/R-3.4.0/library")
adf.test(sales.ts, alternative = c("stationary") )
adf.test(ts2, alternative = c("stationary") )
ts2<-diff(sales.ts, differences = 3)
ts2<-diff(sales.ts, differences = 2)
ts3<-diff(sales.ts, differences = 3)
adf.test(ts3, alternative = c("stationary") )
ts4<-diff(sales.ts, differences = 4)
adf.test(ts4, alternative = c("stationary") )
ts4<-diff(sales.ts, lag=4, differences = 4)
adf.test(ts4, alternative = c("stationary") )
plot(ts4)
ts4<-diff(sales.ts, differences = 4)
plot(ts4)
ts4<-diff(sales.ts, differences = 5)
adf.test(ts5, alternative = c("stationary") )
adf.test(ts4, alternative = c("stationary") )
acf(ts2,main="")
pacf(ts2,main="")
acf(ts2,main="")
pacf(ts2,main="")
plot(ts2)
plot(sales.ts)
auto.arima(sales.data_ts, seasonal = TRUE)
auto.arima(sales.data_ts, seasonal = FALSE)
auto.arima(sales.data_ts, seasonal = TRUE)
fit<-auto.arima(sales.data_ts, seasonal=TRUE)
tsdisplay(residuals(fit), lag.max=45, main='(1,1,1) Model Residuals')
tsdisplay(residuals(fit), lag.max=45, main='(2,0,0) Model Residuals')
auto.arima(sales.ts, seasonal = TRUE)
fit<-auto.arima(sales.ts, seasonal=TRUE)
tsdisplay(residuals(fit), lag.max=45, main='(1,0,0)(1,1,0)[12]  Model Residuals')
fcast <- forecast(fit, h=6)
plot(fcasr)
plot(fcast)
fcast <- forecast(fit, h=12)
plot(fcast)
library('ggplot2')
library('forecast')
library('tseries')
rentacar <-read.csv("c:\\?¨ê¸°.csv", header=T, sep=",")
rentacar.ts <- ts(rentacar[,2]
)
rentacar.ts
rentacar.ts <- ts(rentacar[,2],start=c(2010,1), frequency = 12)
rentacar.ts
> adf.test(rentacar.ts, alternative = c("stationary") )
adf.test(rentacar.ts, alternative = c("stationary") )
plot(rentacar.ts)
decompose(rentacar.ts)
rentacar.decompose <-decompose(rentacar.ts)
plot(rentacar.decompose)
rentacar.ts.data <- rentacar.ts[1:78]
rentacar.ts.test <- rentacar.ts[79:84]
acf(rentacar.ts.data,main="")
pacf(rentacar.ts.data,main="")
rentacar.ts.diff <- diff(rentacar.ts.data, differences = 1)
plot(rentacar.ts.diff)
rentacar.ts.diff <- diff(rentacar.ts.data, differences = 2)
plot(rentacar.ts.diff)
pacf(rentacar.ts.data,main="")
plot(rentacar.decompose)
plot(rentacar.ts.diff)
plot(rentacar.ts.diff, type="l")
rentacar.ts.diff <- diff(rentacar.ts.data, differences = 1)
plot(rentacar.ts.diff, type="l")
rentacar.ts.diff <- diff(rentacar.ts.data, differences = 1)
rentacar.ts.diff <- diff(rentacar.ts.data, differences = 2)
plot(rentacar.ts.diff, type="l")
acf(rentacar.ts.diff,main="")
pacf(rentacar.ts.diff,main="")
auto.arima(rentacar.ts.data, seasonal = FALSE)
auto.arima(rentacar.ts.data, seasonal = TRUE)
rentacar.fit <-auto.arima(rentacar.ts.data, seasonal = TRUE)
rentacar.forecast <- forecast(rentacar.fit,h=6)
plot(rentacar.forecast)
rentacar.forecast
rentacar.ts.test
me()
library("forecast", lib.loc="C:/Program Files/R/R-3.4.0/library")
me()
install.packages("hydroGOF")
library("hydroGOF", lib.loc="C:/Program Files/R/R-3.4.0/library")
library("hydroTSM", lib.loc="C:/Program Files/R/R-3.4.0/library")
me()
mpe()
mape()
mase()
ets()
library('ggplot2')
library('forecast')
library('tseries')
rentacar <-read.csv("c:\\?¨ê¸°.csv", header=T, sep=",")
rentacar.ts <- ts(rentacar[,2])
> rentacar.ts <- ts(rentacar[,2],start=c(2010,1), frequency = 12)
rentacar.ts <- ts(rentacar[,2],start=c(2010,1), frequency = 12)
ets(rentacar.ts)
fit <-ets(rentacar.ts)
plot(forecast(fit))
fit2 <-auto.arima(rentacar.ts, seasonal = TRUE)
plot(forecast(fit2))
fit2
library('ggplot2')
library('forecast')
library('tseries')
rentacar <-read.csv("c:\\?¨ê¸°.csv", header=T, sep=",")
rentacar.ts <- ts(rentacar[,2],start=c(2010,1), frequency = 12)
plot(rentacar.ts)
rentacar.fit <-auto.arima(rentacar.ts.data, seasonal = TRUE)
rentacar.fit <-auto.arima(rentacar.ts, seasonal = TRUE)
tsdisplay(residuals(fit), main='(1,1,0) Model Residuals')
tsdisplay(residuals(rentacar.fit), main='(1,1,0) Model Residuals')
rentacar.fit
tsdisplay(residuals(rentacar.fit), main='ARIMA(1,1,0)(2,0,0)[12] Model Residuals')
rentacar.fit
rentacar.fit <-auto.arima(rentacar.ts.data, seasonal = TRUE)
rentacar.fit <-auto.arima(rentacar.ts, seasonal = TRUE)
rentacar.fit
q()
install.packages("swirl")
packageVersion("swirl")
library(swirl)
install_from_swirl("R Programming")
install.packages("curl")
install_from_swirl("R Programming")
library(curl)
install.packages("curl")
install.packages("curl")
install.packages("curl")
quit()
install.package("curl")
install.packages("curl")
quit()
quit()
install.packages("curl")
q()
x <- matrix(1:6,2,3)
x
setwd("C:/Users/02530/Assignment2/ProgrammingAssignment2")
Source("cachematrix.R")
source("cachematrix.R")
source("cachematrix.R")
aVector <- makeVector(1:10)
m1 <- matrix(c(1/2, -1/4, -1, 3/4), nrow = 2, ncol = 2)
m1
I2 <- matrix(c(1,0,0,1), nrow = 2, ncol = 2)
I2
n1 <- matrix(c(6,2,8,4), nrow = 2, ncol = 2)
n1
m1 %*% n1
n1 %*% m1
solve(m1)
solve(n1)
myMatrix_object <- makeCacheMatrix(m1)
cacheSolve(myMatrix_object)
cacheSolve(myMatrix_object)
n2 <- matrix(c(5/8, -1/8, -7/8, 3/8), nrow = 2, ncol = 2)
myMatrix_object$set(n2)
cacheSolve(myMatrix_object)
cacheSolve(myMatrix_object)
